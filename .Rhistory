group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid=sum(Paid_value/Exchange,na.rm=TRUE)) %>%
filter(Currency_type=="USD"& Manufacturer=="CinnaGen")
dd=Paid %>% full_join(Payment)
Paid=data_66 %>%
group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value/Exchange,na.rm=TRUE))
Payment=data_6 %>%
group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid_payment=sum(Paid_value/Exchange,na.rm=TRUE))
dd=Paid %>% full_join(Payment) %>%
mutate(dd=Total_Paid_paid-Total_Paid_payment)
write.csv(dd,"D:/Naser/Shiny & Power BI/Export Shiny app/Archive/data/Editted data/diff.csv")
View(data_66)
Paid=data_66 %>%
group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE))
Payment=data_6 %>%
group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid_payment=sum(Paid_value,na.rm=TRUE))
dd=Paid %>% full_join(Payment) %>%
mutate(dd=Total_Paid_paid-Total_Paid_payment)
write.csv(dd,"D:/Naser/Shiny & Power BI/Export Shiny app/Archive/data/Editted data/diff.csv")
Paid=data_66 %>%
group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE))
# %>%
#   filter(Currency_type=="USD"& Manufacturer=="CinnaGen")
Payment=data_6 %>%
group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid_payment=sum(Paid_value,na.rm=TRUE))
# %>%
#   filter(Currency_type=="USD"& Manufacturer=="CinnaGen")
dd=Paid %>% full_join(Payment) %>%
mutate(dd=Total_Paid_paid-Total_Paid_payment)
write.csv(dd,"D:/Naser/Shiny & Power BI/Export Shiny app/Archive/data/Editted data/diff.csv")
path ="D:/Naser/Shiny & Power BI/Export Shiny app/Archive/data/Editted data/Finance 30 Aug 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
data_Status=read_xlsx(path, sheet = "Status")
data_PI=read_xlsx(path, sheet = "PI") %>%
mutate(Payment_date =  ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shinpment_cost,
Payment_value=Payment_term*Grand_total)
library(shiny)
library(bslib)
library(readxl)
library(rsconnect)
library(dplyr)
library(ggplot2)
library(plotly)
library(tidyverse)
library(DT)
library(RColorBrewer)
library(tidyr)
library(scales)
library(shinymanager)
library(reactable)
library(shiny)
library(httr)
library(jsonlite)
path ="D:/Naser/Shiny & Power BI/Export Shiny app/Archive/data/Editted data/Finance 30 Aug 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
data_Status=read_xlsx(path, sheet = "Status")
data_PI=read_xlsx(path, sheet = "PI") %>%
mutate(Payment_date =  ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shinpment_cost,
Payment_value=Payment_term*Grand_total)
data_Invoice=read_xlsx(path, sheet = "Invoice") %>%
mutate(Payment_date = ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shinpment_cost,
Payment_value=Payment_term*Grand_total)
Payment_data <- data_PI %>%
bind_rows(data_Invoice)%>%
group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI"))
Paid_data=data_Paid
data_6=payment_function(Payment = Payment_data,Paid = Paid_data)%>%
mutate(Remain_payment=Payment_value-Paid_value,
Payment_status=if_else(Paid_value>=Payment_value,"Paid","Unpaid"),
Time_remain=as.numeric(Payment_date-today()),
Time_remain =case_when(Payment_status == "Paid" ~ NA_real_,TRUE ~ Time_remain ),
Time_delay=as.numeric(Paid_date-Payment_date),
Time_delay =case_when(Payment_status == "Unpaid" ~ NA_real_,TRUE ~ Time_delay )) %>%
ungroup()
data_66=data_Paid  %>%
left_join(
data_PI %>%
bind_rows(data_Invoice )%>% group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI")) %>%
distinct(Order_number,Currency_type,Manufacturer,Country,Consignee)) %>%
mutate(Paid_date =  ymd(paste0(Paid_year, "-", Paid_month, "-", Paid_day)))
data_666=data_Status
###########################
d_payment=data_6%>%
distinct(Invoice, .keep_all = TRUE)%>%
group_by(Order_number)%>%
summarise(Grand_total=sum(Grand_total,na.rm=TRUE))%>%
left_join(data_66 %>%
group_by(Order_number) %>%
summarise(Total_Paid=sum(Paid_value,na.rm=TRUE))) %>%
left_join(data_6 %>%
distinct(Order_number, .keep_all = TRUE) %>% select(-Grand_total))%>%
mutate(Total_Paid=if_else(is.na(Total_Paid),0,Total_Paid)) %>%
select("Order_number","Manufacturer","Invoice","Year",
"Invoice_type","Country","Consignee","Exchange",
"Currency_type","Grand_total","Total_Paid") %>%
mutate(Additional_Payment=if_else(Total_Paid>Grand_total,Total_Paid-Grand_total,0))
Paid=data_66 %>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year==2025) %>%
group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE))
Payment=data_6 %>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year==2025) %>%
group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_payment=sum(Paid_value,na.rm=TRUE))
dd=Paid %>% full_join(Payment) %>%
mutate(dd=Total_Paid_paid-Total_Paid_payment)
View(dd)
Paid=data_66 %>%
filter(Currency_type=="USD" & Manufacturer=="CinnaGen" & Year==2025) %>%
group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE))
Payment=data_6 %>%
filter(Currency_type=="USD" & Manufacturer=="CinnaGen" & Year==2025) %>%
group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_payment=sum(Paid_value,na.rm=TRUE))
dd=Paid %>% full_join(Payment) %>%
mutate(dd=Total_Paid_paid-Total_Paid_payment)
Paid=data_66 %>%
# filter(Currency_type=="USD" & Manufacturer=="CinnaGen" & Year==2025) %>%
group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE))
Payment=data_6 %>%
# filter(Currency_type=="USD" & Manufacturer=="CinnaGen" & Year==2025) %>%
group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_payment=sum(Paid_value,na.rm=TRUE))
dd=Paid %>% full_join(Payment) %>%
mutate(dd=Total_Paid_paid-Total_Paid_payment)
View(dd)
d=data_6 %>%
filter(!is.na(Order_number)) %>%
mutate(Paid_value=Paid_value/Exchange)%>%
group_by(Year) %>%
summarise(Paid = sum(Paid_value, na.rm = TRUE)) %>%
filter(Paid!=0)
d1= data_6 %>%
filter(!is.na(Order_number)& Time_remain<0)%>%
mutate(Paid_value=Payment_value/Exchange)%>%
group_by(Year) %>%
summarise(Paid = sum(Paid_value, na.rm = TRUE))%>%
filter(Paid!=0)
View(d)
View(d1)
View(d)
install.packages(c("boot", "Matrix"))
install.packages(c("broom", "commonmark", "cowplot", "credentials", "crosstalk", "curl", "data.table", "dbplyr", "DT", "dtplyr", "evaluate", "flextable", "gargle", "gdtools", "gemini.R", "ggiraph", "ggplot2", "gh", "googledrive", "googleLanguageR", "googlesheets4", "haven", "httr2", "later", "magrittr", "officer", "openssl", "packrat", "patchwork", "pillar", "pkgbuild", "pkgdown", "PKI", "plotly", "promises", "purrr", "quantmod", "ragg", "Rcpp", "RcppArmadillo", "renv", "roxygen2", "rprojroot", "rsconnect", "RSQLite", "rvest", "shiny", "stringr", "survey", "textshaping", "tibble", "TOSTER", "usethis", "utf8", "waldo", "xfun", "xml2", "zip"))
install.packages("magrittr")
const tabButtons = document.querySelectorAll('.pd-tab-btn');
shiny::runApp('C:/Users/StatDep/Desktop/stability-test')
runApp('D:/Naser/Shiny & Power BI/Export Shiny app/Payment-warning')
runApp('D:/Naser/Shiny & Power BI/Export Shiny app/Payment-warning')
shiny::runApp()
renv::init()
shiny::runApp()
shiny::runApp()
runApp()
shiny::runApp()
runApp()
runApp()
install.packages("rsconnect")
install.packages("rsconnect")
shiny::runApp()
install.packages("rsconnect")
runApp()
renv::init()
install.packages("renv")
renv::init()
shiny::runApp()
ff=function(Paid_value,Payment_value){
x=data.frame(Paid_value,Payment_value)
for(i in 1:(nrow(x)-1)){
x[i+1,"Paid_value"]=x[i,"Paid_value"]-x[i,"Payment_value"]
}
for(i in 1:(nrow(x))){
if(x[i,"Paid_value"]>x[i,"Payment_value"]){
x[i,"Paid_value"] <- x[i,"Payment_value"]
}
}
return(x$Paid_value)
}
fff=function(Payment_data,Paid_data){
Payment_data= Payment_data %>% mutate(Paid_value=NA,Paid_year=NA,Paid_month=NA,Paid_day=NA)
c=0
j=0
if(nrow(Paid_data)>0){
for(i in 1:nrow(Payment_data)){
if(i>1 ){if( Payment_data$Paid_value[i-1]<Payment_data$Payment_value[i-1] ){
break
}}
repeat {
if(round(c,2)>=round(Payment_data$Payment_value[i],2) ){
Payment_data$Paid_value[i]=Payment_data$Payment_value[i]
Payment_data$Paid_year[i]=Paid_data$Paid_year[j]
Payment_data$Paid_month[i]=Paid_data$Paid_month[j]
Payment_data$Paid_day[i]=Paid_data$Paid_day[j]
c=c-Payment_data$Paid_value[i]
break
}
if( j == nrow(Paid_data)){
Payment_data$Paid_value[i]=c
break
}
j=j+1
c=c+Paid_data$Paid_value[j]
}
}
}
g=Payment_data %>% mutate(Paid_date =  ymd(paste0(Paid_year, "-", Paid_month, "-", Paid_day)),
Paid_month= month(Paid_date, label = TRUE)) %>%
select(-c(Paid_year,Paid_month,Paid_day))
g[["Paid_value"]][is.na(g[["Paid_value"]])]=0
return( g)
}
payment_function=function(Payment, Paid){
i=sort(unique(Payment$Order_number))[1]
d_Payment=Payment %>% filter(Order_number==i)
d_Paid=Paid %>% filter(Order_number==i)
g=fff(Payment_data = d_Payment,Paid_data = d_Paid)
# g[["Paid_value"]][is.na(g[["Paid_value"]])]=0
for(i in sort(unique(Payment$Order_number))[-1]){
d_Payment=Payment %>% filter(Order_number==i)
d_Paid=Paid %>% filter(Order_number==i)
g=g %>%bind_rows(fff(Payment_data = d_Payment,Paid_data = d_Paid))
# g[["Paid_value"]][is.na(g[["Paid_value"]])]=0
}
return(g)
}
path ="D:/Naser/Shiny & Power BI/Editted data/Finance 17 Nov 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
data_Status=read_xlsx(path, sheet = "Status")
data_PI=read_xlsx(path, sheet = "PI") %>%
mutate(Payment_date =  ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shinpment_cost,
Payment_value=Payment_term*Grand_total)
runApp()
runApp()
path ="D:/Naser/Shiny & Power BI/Export Shiny app/Archive/data/Editted data/Finance 30 Aug 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
path ="D:/Naser/Shiny & Power BI/Editted data/Finance 17 Nov 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
data_Status=read_xlsx(path, sheet = "Status")
data_PI=read_xlsx(path, sheet = "PI") %>%
mutate(Payment_date =  ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shipment_cost,
Payment_value=Payment_term*Grand_total)
data_Invoice=read_xlsx(path, sheet = "Invoice") %>%
mutate(Payment_date = ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shipment_cost,
Payment_value=Payment_term*Grand_total)
Payment_data <- data_PI %>%
bind_rows(data_Invoice)%>%
group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI"))
Paid_data=data_Paid
data_6=payment_function(Payment = Payment_data,Paid = Paid_data)%>%
mutate(Remain_payment=Payment_value-Paid_value,
Payment_status=if_else(Paid_value>=Payment_value,"Paid","Unpaid"),
Time_remain=as.numeric(Payment_date-today()),
Time_remain =case_when(Payment_status == "Paid" ~ NA_real_,TRUE ~ Time_remain ),
Time_delay=as.numeric(Paid_date-Payment_date),
Time_delay =case_when(Payment_status == "Unpaid" ~ NA_real_,TRUE ~ Time_delay )) %>%
ungroup()
data_6=payment_function(Payment = Payment_data,Paid = Paid_data)%>%
mutate(Remain_payment=Payment_value-Paid_value,
Payment_status=if_else(Paid_value>=Payment_value,"Paid","Unpaid"),
Time_remain=as.numeric(Payment_date-today()),
Time_remain =case_when(Payment_status == "Paid" ~ NA_real_,TRUE ~ Time_remain ),
Time_delay=as.numeric(Paid_date-Payment_date),
Time_delay =case_when(Payment_status == "Unpaid" ~ NA_real_,TRUE ~ Time_delay )) %>%
ungroup()
Payment = Payment_data
Paid = Paid_data
View(payment_function)
View(payment_function)
i=sort(unique(Payment$Order_number))[1]
d_Payment=Payment %>% filter(Order_number==i)
d_Paid=Paid %>% filter(Order_number==i)
g=fff(Payment_data = d_Payment,Paid_data = d_Paid)
# g[["Paid_value"]][is.na(g[["Paid_value"]])]=0
for(i in sort(unique(Payment$Order_number))[-1]){
d_Payment=Payment %>% filter(Order_number==i)
d_Paid=Paid %>% filter(Order_number==i)
g=g %>%bind_rows(fff(Payment_data = d_Payment,Paid_data = d_Paid))
# g[["Paid_value"]][is.na(g[["Paid_value"]])]=0
}
i=sort(unique(Payment$Order_number))[1]
d_Payment=Payment %>% filter(Order_number==i)
d_Paid=Paid %>% filter(Order_number==i)
g=fff(Payment_data = d_Payment,Paid_data = d_Paid)
# g[["Paid_value"]][is.na(g[["Paid_value"]])]=0
for(i in sort(unique(Payment$Order_number))[-1]){
d_Payment=Payment %>% filter(Order_number==i)
d_Paid=Paid %>% filter(Order_number==i)
g=g %>%bind_rows(fff(Payment_data = d_Payment,Paid_data = d_Paid))
# g[["Paid_value"]][is.na(g[["Paid_value"]])]=0
cat(i)
}
i=sort(unique(Payment$Order_number))[1]
d_Payment=Payment %>% filter(Order_number==i)
d_Paid=Paid %>% filter(Order_number==i)
g=fff(Payment_data = d_Payment,Paid_data = d_Paid)
# g[["Paid_value"]][is.na(g[["Paid_value"]])]=0
for(i in sort(unique(Payment$Order_number))[-1]){
cat(i,"\n")
d_Payment=Payment %>% filter(Order_number==i)
d_Paid=Paid %>% filter(Order_number==i)
g=g %>%bind_rows(fff(Payment_data = d_Payment,Paid_data = d_Paid))
# g[["Paid_value"]][is.na(g[["Paid_value"]])]=0
}
d_Payment=Payment %>% filter(Order_number==i)
d_Paid=Paid %>% filter(Order_number==i)
g=fff(Payment_data = d_Payment,Paid_data = d_Paid)
View(d_Payment)
View(d_Paid)
library(shiny)
library(bslib)
library(readxl)
library(rsconnect)
library(dplyr)
library(ggplot2)
library(plotly)
library(tidyverse)
library(DT)
library(RColorBrewer)
library(tidyr)
library(scales)
library(shinymanager)
library(reactable)
library(httr)
library(jsonlite)
path ="D:/Naser/Shiny & Power BI/Editted data/Finance 20 Dec 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
data_Status=read_xlsx(path, sheet = "Status")
View(data_Status)
View(d_Paid)
path ="D:/Naser/Shiny & Power BI/Editted data/Finance 20 Dec 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
data_Status=read_xlsx(path, sheet = "Status")
path ="D:/Naser/Shiny & Power BI/Editted data/Finance 20 Dec 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
data_Status=read_xlsx(path, sheet = "Status")
path ="D:/Naser/Shiny & Power BI/Editted data/Finance 20 Dec 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
path ="D:/Naser/Shiny & Power BI/Editted data/Finance 20 Dec 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
data_PI=read_xlsx(path, sheet = "PI") %>%
mutate(Payment_date =  ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shipment_cost,
Payment_value=Payment_term*Grand_total)
data_Invoice=read_xlsx(path, sheet = "Invoice") %>%
mutate(Payment_date = ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shipment_cost,
Payment_value=Payment_term*Grand_total)
Payment_data <- data_PI %>%
bind_rows(data_Invoice)%>%
group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI"))
View(Payment_data)
d=read_xlsx("D:/Naser/Shiny & Power BI/Editted data/ER-21.12.2025.xlsx")
colnames(d)
cat("SDf\rsd\n")
cat("SDf\rsd\nadf")
d=read_xlsx("D:/Naser/Shiny & Power BI/Editted data/ER-21.12.2025.xlsx") %>%
select(Invoice,Medicine,Dosage ,Category )
View(d)
d=read_xlsx("D:/Naser/Shiny & Power BI/Editted data/ER-21.12.2025.xlsx") %>%
select(Manufacturer,Invoice,Medicine,Dosage ,Category )
d
# Save updated file
writexl::write_xlsx(d, "D:/Naser/Shiny & Power BI/Editted data/ssss.xlsx")
df <- d %>%
mutate(
Invoice = case_when(
str_starts(Invoice, "AG") ~ Invoice,
str_starts(Invoice, "CG") ~ Invoice,
str_detect(Invoice, "^[0-9]") & Manufacturer == "AryoGen"  ~ paste0("AG", Invoice),
str_detect(Invoice, "^[0-9]") & Manufacturer == "CinnaGen" ~ paste0("CG", Invoice),
TRUE ~ Invoice
)
)
View(df)
d=read_xlsx("D:/Naser/Shiny & Power BI/Editted data/ER-21.12.2025.xlsx") %>%
select(Manufacturer,Invoice,Medicine,Dosage ,Category )
df <- d %>%
mutate(
Invoice = case_when(
str_starts(Invoice, "AG") ~ Invoice,
str_starts(Invoice, "CG") ~ Invoice,
str_detect(Invoice, "^[0-9]") & Manufacturer == "AryoGen"  ~ paste0("AG-", Invoice),
str_detect(Invoice, "^[0-9]") & Manufacturer == "CinnaGen" ~ paste0("CG-", Invoice),
TRUE ~ Invoice
)
)
writexl::write_xlsx(df, "D:/Naser/Shiny & Power BI/Editted data/ssss.xlsx")
df <- d %>%
mutate(
Invoice = case_when(
str_starts(Invoice, "AG") ~ Invoice,
str_starts(Invoice, "CG") ~ Invoice,
str_detect(Invoice, "^[0-9]") & Manufacturer == "AryoGen"  ~ paste0("AG-", Invoice),
str_detect(Invoice, "^[0-9]") & Manufacturer == "CinnaGen" ~ paste0("CG-", Invoice),
TRUE ~ Invoice
)
)%>%
mutate(medicine_dosage = paste(Medicine, Dosage, sep = " "))
df_unique <- df %>%
filter(!is.na(Invoice) & Invoice != "") %>%
group_by(Manufacturer, Invoice, Category) %>%
summarise(
medicine_dosage_list = paste(medicine_dosage, collapse = ", "),
.groups = "drop"
)
View(df_unique)
View(data_PI)
View(df_unique)
path ="D:/Naser/Shiny & Power BI/Editted data/Finance 20 Dec 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
# data_Status=read_xlsx(path, sheet = "Status")
data_PI=read_xlsx(path, sheet = "PI") %>%
mutate(Payment_date =  ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shipment_cost,
Payment_value=Payment_term*Grand_total)
data_Invoice=read_xlsx(path, sheet = "Invoice") %>%
mutate(Payment_date = ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shipment_cost,
Payment_value=Payment_term*Grand_total)
Payment_data <- data_PI %>%
bind_rows(data_Invoice)%>%
group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI"))
d=read_xlsx("D:/Naser/Shiny & Power BI/Editted data/ER-21.12.2025.xlsx") %>%
select(Manufacturer,Invoice,Medicine,Dosage ,Category )
df <- d %>%
mutate(
Invoice = case_when(
str_starts(Invoice, "AG") ~ Invoice,
str_starts(Invoice, "CG") ~ Invoice,
str_detect(Invoice, "^[0-9]") & Manufacturer == "AryoGen"  ~ paste0("AG-", Invoice),
str_detect(Invoice, "^[0-9]") & Manufacturer == "CinnaGen" ~ paste0("CG-", Invoice),
TRUE ~ Invoice
)
)%>%
mutate(medicine_dosage = paste(Medicine, Dosage, sep = " ")) %>%
filter(!is.na(Invoice) & Invoice != "") %>%
group_by(Manufacturer, Invoice, Category) %>%
summarise(
medicine_dosage_list = paste(medicine_dosage, collapse = ", "),
.groups = "drop"
)
View(df)
path ="D:/Naser/Shiny & Power BI/Editted data/Finance 20 Dec 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
# data_Status=read_xlsx(path, sheet = "Status")
data_PI=read_xlsx(path, sheet = "PI") %>%
mutate(Payment_date =  ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shipment_cost,
Payment_value=Payment_term*Grand_total)
data_Invoice=read_xlsx(path, sheet = "Invoice") %>%
mutate(Payment_date = ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shipment_cost,
Payment_value=Payment_term*Grand_total)
Payment_data <- data_PI %>%
bind_rows(data_Invoice)%>%
group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI"))
d=read_xlsx("D:/Naser/Shiny & Power BI/Editted data/ER-21.12.2025.xlsx") %>%
select(Manufacturer,Invoice,Medicine,Dosage )
df <- d %>%
mutate(
Invoice = case_when(
str_starts(Invoice, "AG") ~ Invoice,
str_starts(Invoice, "CG") ~ Invoice,
str_detect(Invoice, "^[0-9]") & Manufacturer == "AryoGen"  ~ paste0("AG-", Invoice),
str_detect(Invoice, "^[0-9]") & Manufacturer == "CinnaGen" ~ paste0("CG-", Invoice),
TRUE ~ Invoice
)
)%>%
mutate(medicine_dosage = paste(Medicine, Dosage, sep = " ")) %>%
filter(!is.na(Invoice) & Invoice != "") %>%
group_by(Manufacturer, Invoice) %>%
summarise(
medicine_dosage_list = paste(medicine_dosage, collapse = ", "),
.groups = "drop"
)
writexl::write_xlsx(df, "D:/Naser/Shiny & Power BI/Editted data/ssss.xlsx")
writexl::write_xlsx(df, "D:/Naser/Shiny & Power BI/Editted data/ssss.xlsx")
shiny::runApp()
runApp()
runApp()
shiny::runApp()

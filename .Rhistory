# Install and load the ggplot2 package if you haven't already
# install.packages("ggplot2")
library(ggplot2)
# Create the data frame
sales_data <- data.frame(
Year = c(2024, 2024, 2025, 2025),
Type = c("Real", "Target", "Real", "Target"),
Out = c(28242320.00, NA, 23975252.00, 33890784.00)
)
# Convert 'Year' to a factor for proper grouping on the x-axis
sales_data$Year <- as.factor(sales_data$Year)
# Create the clustered column chart
ggplot(sales_data, aes(x = Year, y = Out, fill = Type)) +
geom_col(position = "dodge") + # geom_col creates bar charts, position = "dodge" puts bars side-by-side
labs(
title = "Real vs. Target Sales by Year",
x = "Year",
y = "Sales Amount ($)"
) +
scale_y_continuous(labels = scales::dollar_format()) + # Format y-axis as currency
theme_minimal() + # Use a minimal theme for a clean look
theme(legend.position = "bottom") + # Move legend to the bottom
geom_text(aes(label = scales::dollar(Out)),
position = position_dodge(width = 0.9), # Adjust position to match dodged bars
vjust = -0.5, # Nudge labels slightly above the bars
size = 3) # Adjust label size
# Install and load the ggplot2 package if you haven't already
# install.packages("ggplot2")
library(ggplot2)
# Create the data frame
sales_data <- data.frame(
Year = c(2024, 2024, 2025, 2025),
Type = c("Actual sales", "Target", "Actual sales", "Target"),
Out = c(28242320.00, NA, 23975252.00, 33890784.00)
)
# Convert 'Year' to a factor for proper grouping on the x-axis
sales_data$Year <- as.factor(sales_data$Year)
# Create the clustered column chart
ggplot(sales_data, aes(x = Year, y = Out, fill = Type)) +
geom_col(position = "dodge") + # geom_col creates bar charts, position = "dodge" puts bars side-by-side
labs(
title = "Actual sales vs. Target Sales by Year",
x = "Year",
y = "Sales Amount ($)"
) +
scale_y_continuous(labels = scales::dollar_format()) + # Format y-axis as currency
theme_minimal() + # Use a minimal theme for a clean look
theme(legend.position = "bottom") + # Move legend to the bottom
geom_text(aes(label = scales::dollar(Out)),
position = position_dodge(width = 0.9), # Adjust position to match dodged bars
vjust = -0.5, # Nudge labels slightly above the bars
size = 3) # Adjust label size
# Install and load the ggplot2 package if you haven't already
# install.packages("ggplot2")
library(ggplot2)
# Create the data frame
sales_data <- data.frame(
Year = c(2024, 2024, 2025, 2025),
Type = c("Actual sales", "Target", "Actual sales", "Target"),
Out = c(28242320.00, NA, 23975252.00, 33890784.00)
)
# Convert 'Year' to a factor for proper grouping on the x-axis
sales_data$Year <- as.factor(sales_data$Year)
# Create the clustered column chart
ggplot(sales_data, aes(x = Year, y = Out, fill = Type)) +
geom_col(position = "dodge") + # geom_col creates bar charts, position = "dodge" puts bars side-by-side
labs(
# title = "Actual sales vs. Target Sales by Year",
x = "Year",
y = "Sales Amount ($)"
) +
scale_y_continuous(labels = scales::dollar_format()) + # Format y-axis as currency
theme_minimal() + # Use a minimal theme for a clean look
theme(legend.position = "bottom") + # Move legend to the bottom
geom_text(aes(label = scales::dollar(Out)),
position = position_dodge(width = 0.9), # Adjust position to match dodged bars
vjust = -0.5, # Nudge labels slightly above the bars
size = 3) # Adjust label size
shiny::runApp('D:/Naser/Shiny & Power BI/Export Shiny app/Payment-warning 3.1.1')
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
runApp()
library(shiny)
library(bslib)
library(readxl)
library(rsconnect)
library(dplyr)
library(ggplot2)
library(plotly)
library(tidyverse)
library(DT)
library(RColorBrewer)
library(tidyr)
library(scales)
library(shinymanager)
library(reactable)
library(shiny)
library(httr)
library(jsonlite)
path ="D:/Naser/Shiny & Power BI/Export Shiny app/data/Editted data/Finance 15 April 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
path ="D:/Naser/Shiny & Power BI/Export Shiny app/Archive/data/Editted data/Finance 30 July 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
data_Status=read_xlsx(path, sheet = "Status")
data_PI=read_xlsx(path, sheet = "PI") %>%
mutate(Payment_date =  ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shinpment_cost,
Payment_value=Payment_term*Grand_total)
data_Invoice=read_xlsx(path, sheet = "Invoice") %>%
mutate(Payment_date = ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shinpment_cost,
Payment_value=Payment_term*Grand_total)
Payment_data <- data_PI %>%
bind_rows(data_Invoice)%>%
group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI"))
Paid_data=data_Paid
data_6=payment_function(Payment = Payment_data,Paid = Paid_data)%>%
mutate(Remain_payment=Payment_value-Paid_value,
Payment_status=if_else(Paid_value>=Payment_value,"Paid","Unpaid"),
Time_remain=as.numeric(Payment_date-today()),
Time_remain =case_when(Payment_status == "Paid" ~ NA_real_,TRUE ~ Time_remain ),
Time_delay=as.numeric(Paid_date-Payment_date),
Time_delay =case_when(Payment_status == "Unpaid" ~ NA_real_,TRUE ~ Time_delay )) %>%
ungroup()
ff=function(Paid_value,Payment_value){
x=data.frame(Paid_value,Payment_value)
for(i in 1:(nrow(x)-1)){
x[i+1,"Paid_value"]=x[i,"Paid_value"]-x[i,"Payment_value"]
}
for(i in 1:(nrow(x))){
if(x[i,"Paid_value"]>x[i,"Payment_value"]){
x[i,"Paid_value"] <- x[i,"Payment_value"]
}
}
return(x$Paid_value)
}
fff=function(Payment_data,Paid_data){
Payment_data= Payment_data %>% mutate(Paid_value=NA,Paid_year=NA,Paid_month=NA,Paid_day=NA)
c=0
j=0
if(nrow(Paid_data)>0){
for(i in 1:nrow(Payment_data)){
if(i>1 ){if( Payment_data$Paid_value[i-1]<Payment_data$Payment_value[i-1] ){
break
}}
repeat {
if(round(c,2)>=round(Payment_data$Payment_value[i],2) ){
Payment_data$Paid_value[i]=Payment_data$Payment_value[i]
Payment_data$Paid_year[i]=Paid_data$Paid_year[j]
Payment_data$Paid_month[i]=Paid_data$Paid_month[j]
Payment_data$Paid_day[i]=Paid_data$Paid_day[j]
c=c-Payment_data$Paid_value[i]
break
}
if( j == nrow(Paid_data)){
Payment_data$Paid_value[i]=c
break
}
j=j+1
c=c+Paid_data$Paid_value[j]
}
}
}
g=Payment_data %>% mutate(Paid_date =  ymd(paste0(Paid_year, "-", Paid_month, "-", Paid_day)),
Paid_month= month(Paid_date, label = TRUE)) %>%
select(-c(Paid_year,Paid_month,Paid_day))
g[["Paid_value"]][is.na(g[["Paid_value"]])]=0
return( g)
}
payment_function=function(Payment, Paid){
i=sort(unique(Payment$Order_number))[1]
d_Payment=Payment %>% filter(Order_number==i)
d_Paid=Paid %>% filter(Order_number==i)
g=fff(Payment_data = d_Payment,Paid_data = d_Paid)
# g[["Paid_value"]][is.na(g[["Paid_value"]])]=0
for(i in sort(unique(Payment$Order_number))[-1]){
d_Payment=Payment %>% filter(Order_number==i)
d_Paid=Paid %>% filter(Order_number==i)
g=g %>%bind_rows(fff(Payment_data = d_Payment,Paid_data = d_Paid))
# g[["Paid_value"]][is.na(g[["Paid_value"]])]=0
}
return(g)
}
path ="D:/Naser/Shiny & Power BI/Export Shiny app/Archive/data/Editted data/Finance 30 July 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
data_Status=read_xlsx(path, sheet = "Status")
data_PI=read_xlsx(path, sheet = "PI") %>%
mutate(Payment_date =  ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shinpment_cost,
Payment_value=Payment_term*Grand_total)
data_Invoice=read_xlsx(path, sheet = "Invoice") %>%
mutate(Payment_date = ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shinpment_cost,
Payment_value=Payment_term*Grand_total)
Payment_data <- data_PI %>%
bind_rows(data_Invoice)%>%
group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI"))
Paid_data=data_Paid
data_6=payment_function(Payment = Payment_data,Paid = Paid_data)%>%
mutate(Remain_payment=Payment_value-Paid_value,
Payment_status=if_else(Paid_value>=Payment_value,"Paid","Unpaid"),
Time_remain=as.numeric(Payment_date-today()),
Time_remain =case_when(Payment_status == "Paid" ~ NA_real_,TRUE ~ Time_remain ),
Time_delay=as.numeric(Paid_date-Payment_date),
Time_delay =case_when(Payment_status == "Unpaid" ~ NA_real_,TRUE ~ Time_delay )) %>%
ungroup()
data_66=data_Paid  %>%
left_join(
data_PI %>%
bind_rows(data_Invoice )%>% group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI")) %>%
distinct(Order_number,Currency_type,Manufacturer,Country,Consignee)) %>%
mutate(Paid_date =  ymd(paste0(Paid_year, "-", Paid_month, "-", Paid_day)))
###########################
d_paid=data_66 %>%
group_by(Order_number) %>%
summarise(Paid_value=sum(Paid_value,na.rm=TRUE))
View(d_paid)
d_payment=data_6%>%
distinct(Order_number, .keep_all = TRUE) %>%
left_join(d_paid)
View(d_payment)
###########################
d_paid=data_66 %>%
group_by(Order_number) %>%
summarise(Total_Paid=sum(Paid_value,na.rm=TRUE))
d_payment=data_6%>%
distinct(Order_number, .keep_all = TRUE) %>%
left_join(d_paid)
View(d_payment)
d_payment=data_6%>%
distinct(Order_number, .keep_all = TRUE) %>%
left_join(d_paid) %>%
mutate(Total_Paid=if_else(is.na(Total_Paid),0,Total_Paid))
colnames(d_payment)
colnames(d_payment)
"Order_number","Manufacturer"   "Invoice"
###########################
d_payment=data_6%>%
distinct(Order_number, .keep_all = TRUE) %>%
left_join(data_66 %>%
group_by(Order_number) %>%
summarise(Total_Paid=sum(Paid_value,na.rm=TRUE)))%>%
mutate(Total_Paid=if_else(is.na(Total_Paid),0,Total_Paid)) %>%
select("Order_number","Manufacturer","Invoice","Year",
"Invoice_type","Country","Consignee","Exchange",
"Currency_type","Grand_total","Total_Paid") %>%
mutate(Additional_Payment=if_else(Total_Paid>Grand_total,Total_Paid-Grand_total,0))
runApp()
shiny::runApp()
1:2 %in% 1:10
1:5%in%1;2
runApp()
path ="D:/Naser/Shiny & Power BI/Export Shiny app/Archive/data/Editted data/Finance 26 Aug 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
library(shiny)
library(bslib)
library(readxl)
library(rsconnect)
library(dplyr)
library(ggplot2)
library(plotly)
library(tidyverse)
library(DT)
library(RColorBrewer)
library(tidyr)
library(scales)
library(shinymanager)
library(reactable)
library(shiny)
library(httr)
library(jsonlite)
path ="D:/Naser/Shiny & Power BI/Export Shiny app/Archive/data/Editted data/Finance 26 Aug 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
data_Status=read_xlsx(path, sheet = "Status")
data_PI=read_xlsx(path, sheet = "PI") %>%
mutate(Payment_date =  ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shinpment_cost,
Payment_value=Payment_term*Grand_total)
data_Invoice=read_xlsx(path, sheet = "Invoice") %>%
mutate(Payment_date = ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shinpment_cost,
Payment_value=Payment_term*Grand_total)
Payment_data <- data_PI %>%
bind_rows(data_Invoice)%>%
group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI"))
Paid_data=data_Paid
data_6=payment_function(Payment = Payment_data,Paid = Paid_data)%>%
mutate(Remain_payment=Payment_value-Paid_value,
Payment_status=if_else(Paid_value>=Payment_value,"Paid","Unpaid"),
Time_remain=as.numeric(Payment_date-today()),
Time_remain =case_when(Payment_status == "Paid" ~ NA_real_,TRUE ~ Time_remain ),
Time_delay=as.numeric(Paid_date-Payment_date),
Time_delay =case_when(Payment_status == "Unpaid" ~ NA_real_,TRUE ~ Time_delay )) %>%
ungroup()
data_66=data_Paid  %>%
left_join(
data_PI %>%
bind_rows(data_Invoice )%>% group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI")) %>%
distinct(Order_number,Currency_type,Manufacturer,Country,Consignee)) %>%
mutate(Paid_date =  ymd(paste0(Paid_year, "-", Paid_month, "-", Paid_day)))
data_666=data_Status
###########################
d_payment=data_6%>%
distinct(Invoice, .keep_all = TRUE) %>%
group_by(Order_number)%>%
summarise(Grand_total=sum(Grand_total,na.rm=TRUE))%>%
left_join(data_66 %>%
group_by(Order_number) %>%
summarise(Total_Paid=sum(Paid_value,na.rm=TRUE))) %>%
left_join(data_6 %>%
distinct(Order_number, .keep_all = TRUE) %>% select(-Grand_total))%>%
mutate(Total_Paid=if_else(is.na(Total_Paid),0,Total_Paid)) %>%
select("Order_number","Manufacturer","Invoice","Year",
"Invoice_type","Country","Consignee","Exchange",
"Currency_type","Grand_total","Total_Paid") %>%
mutate(Additional_Payment=if_else(Total_Paid>Grand_total,Total_Paid-Grand_total,0))
View(data_6)
###########################
d_payment=data_6%>%
distinct(Invoice, .keep_all = TRUE) %>%
group_by(Order_number)%>%
summarise(Grand_total=sum(Grand_total,na.rm=TRUE))
10*10*10**24*10*10
10*10*10*24*10*10
Paid=data_66 %>%
group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE))
Paid=data_66 %>%
group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE)) %>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year=2025)
Payment=data_6 %>%
group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid_payment=sum(Paid_value,na.rm=TRUE))%>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year=2025)
dd=Paid %>% full_join(Payment) %>%
mutate(dd=Total_Paid_paid-Total_Paid_payment)
Paid=data_66 %>%
group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE)) %>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year=2025)
Payment=data_6 %>%
group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid_payment=sum(Paid_value,na.rm=TRUE))%>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year=2025)
Paid=data_66 %>%
group_by(Order_number,Manufacturer,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE)) %>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year==2025)
data_66$Year
Paid=data_66 %>%
group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE)) %>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year==2025)
Payment=data_6 %>%
group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_payment=sum(Paid_value,na.rm=TRUE))%>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year==2025)
dd=Paid %>% full_join(Payment) %>%
mutate(dd=Total_Paid_paid-Total_Paid_payment)
View(dd)
sum(Paid$Total_Paid_paid
)
Paid=data_66 %>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year==2025) %>%
# group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE)) %>%
Payment=data_6 %>%
group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_payment=sum(Paid_value,na.rm=TRUE))%>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year==2025)
Paid=data_66 %>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" ) %>%
# group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE)) %>%
Payment=data_6 %>%
group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_payment=sum(Paid_value,na.rm=TRUE))%>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year==2025)
Paid=data_66 %>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year==2025) %>%
summarise(Total_Paid_paid=sum(Paid_value,na.rm=TRUE)) %>%
Payment=data_6 %>%
group_by(Order_number,Manufacturer,Year,Currency_type) %>%
summarise(Total_Paid_payment=sum(Paid_value,na.rm=TRUE))%>%
filter(Currency_type=="USD" & Manufacturer=="AryoGen" & Year==2025)
library(shiny)
library(bslib)
library(readxl)
library(rsconnect)
library(dplyr)
library(ggplot2)
library(plotly)
library(tidyverse)
library(DT)
library(RColorBrewer)
library(tidyr)
library(scales)
library(shinymanager)
library(reactable)
library(shiny)
library(httr)
library(jsonlite)
path ="D:/Naser/Shiny & Power BI/Export Shiny app/Archive/data/Editted data/Finance 26 Aug 2025.xlsx"
data_Paid=read_xlsx(path, sheet = "Paid")
data_Status=read_xlsx(path, sheet = "Status")
data_PI=read_xlsx(path, sheet = "PI") %>%
mutate(Payment_date =  ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shinpment_cost,
Payment_value=Payment_term*Grand_total)
data_Invoice=read_xlsx(path, sheet = "Invoice") %>%
mutate(Payment_date = ymd(paste0(Payment_year, "-", Payment_month, "-", Payment_day)),
Payment_month= month(Payment_date, label = TRUE),
Grand_total=Total_value + Shinpment_cost,
Payment_value=Payment_term*Grand_total)
Payment_data <- data_PI %>%
bind_rows(data_Invoice)%>%
group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI"))
Paid_data=data_Paid
data_6=payment_function(Payment = Payment_data,Paid = Paid_data)%>%
mutate(Remain_payment=Payment_value-Paid_value,
Payment_status=if_else(Paid_value>=Payment_value,"Paid","Unpaid"),
Time_remain=as.numeric(Payment_date-today()),
Time_remain =case_when(Payment_status == "Paid" ~ NA_real_,TRUE ~ Time_remain ),
Time_delay=as.numeric(Paid_date-Payment_date),
Time_delay =case_when(Payment_status == "Unpaid" ~ NA_real_,TRUE ~ Time_delay )) %>%
ungroup()
data_66=data_Paid  %>%
left_join(
data_PI %>%
bind_rows(data_Invoice )%>% group_by(Order_number) %>%
filter(!(("Invoice" %in% unique(Invoice_type)) & Invoice_type=="PI")) %>%
distinct(Order_number,Currency_type,Manufacturer,Country,Consignee)) %>%
mutate(Paid_date =  ymd(paste0(Paid_year, "-", Paid_month, "-", Paid_day)))
data_666=data_Status
d=data_6 %>%
filter(!is.na(Order_number)) %>%
mutate(Paid_value=Paid_value/Exchange)%>%
group_by(Year) %>%
summarise(Paid = sum(Paid_value, na.rm = TRUE))
View(d)
d=data_6 %>%
filter(!is.na(Order_number)) %>%
mutate(Paid_value=Paid_value/Exchange)%>%
group_by(Year) %>%
summarise(Paid = sum(Paid_value, na.rm = TRUE)) %>%
filter(!is.na(Paid))
View(d)
d=data_6 %>%
filter(!is.na(Order_number)) %>%
mutate(Paid_value=Paid_value/Exchange)%>%
group_by(Year) %>%
summarise(Paid = sum(Paid_value, na.rm = TRUE)) %>%
filter(Paid==0)
d=data_6 %>%
filter(!is.na(Order_number)) %>%
mutate(Paid_value=Paid_value/Exchange)%>%
group_by(Year) %>%
summarise(Paid = sum(Paid_value, na.rm = TRUE)) %>%
filter(Paid!=0)
runApp()
d1= data_6 %>%
filter(!is.na(Order_number)& Time_remain<0) %>%
mutate(Paid_value=Payment_value/Exchange)%>%
group_by(Year) %>%
summarise(Paid = sum(Paid_value, na.rm = TRUE))%>%
filter(Paid!=0)
View(d1)
d1= data_6 %>%
filter(!is.na(Order_number)& Time_remain<0)
View(d1)
d1= data_6 %>%
filter(!is.na(Order_number)& Time_remain<0)%>%
mutate(Paid_value=Payment_value/Exchange)
View(d1)
sum(d1$Paid_date)
sum(d1$Paid_value)
runApp()
library(shiny)
library(bslib)
library(readxl)
library(rsconnect)
library(dplyr)
library(ggplot2)
library(plotly)
library(tidyverse)
library(DT)
library(RColorBrewer)
library(tidyr)
library(scales)
library(shinymanager)
library(reactable)
library(shiny)
library(httr)
library(jsonlite)
runApp()
shiny::runApp()

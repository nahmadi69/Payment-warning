k <- auto.arima(ts_data)
d2[d2$Visit=="V8","OD/Blank ≥ 3 is positive"] <- forecast(k, h = 1)[4]$mean[1]
d1=d1 %>% bind_rows(d2)
}
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/Screening test"
d=read_xlsx(paste0(path,"/Part 1 test 1.xlsx")) %>% filter(!is.na(Sample))
sample=unique(d$Sample)
i=sample[1]
d1=d %>%
filter(Sample==i) %>%
add_row(Sample = i, Visit = "V8" , )
ts_data <- ts(d1$`Mean of sample OD`[d1$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d1[d1$Visit=="V8","Mean of sample OD"] <- forecast(k, h = 1)[4]$mean[1]
ts_data <- ts(d1$`OD/Blank ≥ 3 is positive`[d1$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d1[d1$Visit=="V8","OD/Blank ≥ 3 is positive"] <- forecast(k, h = 1)[4]$mean[1]
for(i in sample[-1]){
d2=d %>%
filter(Sample==i) %>%
add_row(Sample = i, Visit = "V8" , )
ts_data <- ts(d2$`Mean of sample OD`[d2$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d2[d2$Visit=="V8","Mean of sample OD"] <- forecast(k, h = 1)[4]$mean[1]
ts_data <- ts(d2$`OD/Blank ≥ 3 is positive`[d2$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d2[d2$Visit=="V8","OD/Blank ≥ 3 is positive"] <- forecast(k, h = 1)[4]$mean[1]
d1=d1 %>% bind_rows(d2)
}
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/Screening test"
d=read_xlsx(paste0(path,"/Part 1 test 1.xlsx")) %>% filter(!is.na(Sample))
sample=unique(d$Sample)
i=sample[1]
d1=d %>%
filter(Sample==i) %>%
add_row(Sample = i, Visit = "V8" , )
ts_data <- ts(d1$`Mean of sample OD`[d1$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d1[d1$Visit=="V8","Mean of sample OD"] <- forecast(k, h = 1)$mean[1]
ts_data <- ts(d1$`OD/Blank ≥ 3 is positive`[d1$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d1[d1$Visit=="V8","OD/Blank ≥ 3 is positive"] <- forecast(k, h = 1)$mean[1]
for(i in sample[-1]){
d2=d %>%
filter(Sample==i) %>%
add_row(Sample = i, Visit = "V8" , )
ts_data <- ts(d2$`Mean of sample OD`[d2$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d2[d2$Visit=="V8","Mean of sample OD"] <- forecast(k, h = 1)$mean[1]
ts_data <- ts(d2$`OD/Blank ≥ 3 is positive`[d2$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d2[d2$Visit=="V8","OD/Blank ≥ 3 is positive"] <- forecast(k, h = 1)$mean[1]
d1=d1 %>% bind_rows(d2)
}
i=sample[1]
d2=d %>%
filter(Sample==i) %>%
add_row(Sample = i, Visit = "V8" , )
ts_data <- ts(d2$`Mean of sample OD`[d2$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d2[d2$Visit=="V8","Mean of sample OD"] <- forecast(k, h = 1)$mean[1]
ts_data <- ts(d2$`OD/Blank ≥ 3 is positive`[d2$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d2[d2$Visit=="V8","OD/Blank ≥ 3 is positive"] <- forecast(k, h = 1)$mean[1]
View(d2)
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/Screening test"
d=read_xlsx(paste0(path,"/Part 1 test 1.xlsx")) %>% filter(!is.na(Sample))
sample=unique(d$Sample)
i=sample[1]
d1=d %>%
filter(Sample==i) %>%
add_row(Sample = i, Visit = "V8" , )
ts_data <- ts(d1$`Mean of sample OD`[d1$Sample!="V7"], frequency = 1)
k <- auto.arima(ts_data)
d1[d1$Visit=="V8","Mean of sample OD"] <- forecast(k, h = 1)$mean[1]
ts_data <- ts(d1$`OD/Blank ≥ 3 is positive`[d1$Sample!="V7"], frequency = 1)
k <- auto.arima(ts_data)
d1[d1$Visit=="V8","OD/Blank ≥ 3 is positive"] <- forecast(k, h = 1)$mean[1]
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/Screening test"
d=read_xlsx(paste0(path,"/Part 1 test 1.xlsx")) %>% filter(!is.na(Sample))
sample=unique(d$Sample)
i=sample[1]
d1=d %>%
filter(Sample==i) %>%
add_row(Sample = i, Visit = "V8" , )
ts_data <- ts(d1$`Mean of sample OD`[d1$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d1[d1$Visit=="V8","Mean of sample OD"] <- forecast(k, h = 2)$mean[1]
ts_data <- ts(d1$`OD/Blank ≥ 3 is positive`[d1$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d1[d1$Visit=="V8","OD/Blank ≥ 3 is positive"] <- forecast(k, h = 2)$mean[1]
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>% filter(!is.na(Sample))
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx"))
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>% filter(!is.na(Sample))
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>% filter(!is.na(Sample))
sample=unique(d$Sample)
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>% filter(!is.na(Sample))
sample=unique(d$Sample)
i=sample[1]
d1=d %>%
filter(Sample==i) %>%
add_row(Sample = i, Visit = "V8" , )
ts_data <- ts(d1$`Mean of sample OD`[d1$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d1[d1$Visit=="V8","Mean of sample OD"] <- forecast(k, h = 2)$mean[1]
ts_data <- ts(d1$`OD/Blank ≥ 3 is positive`[d1$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d1[d1$Visit=="V8","OD/Blank ≥ 3 is positive"] <- forecast(k, h = 2)$mean[1]
for(i in sample[-1]){
d2=d %>%
filter(Sample==i) %>%
add_row(Sample = i, Visit = "V8" , )
ts_data <- ts(d2$`Mean of sample OD`[d2$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d2[d2$Visit=="V8","Mean of sample OD"] <- forecast(k, h = 1)$mean[1]
ts_data <- ts(d2$`OD/Blank ≥ 3 is positive`[d2$Sample!="V8"], frequency = 1)
k <- auto.arima(ts_data)
d2[d2$Visit=="V8","OD/Blank ≥ 3 is positive"] <- forecast(k, h = 1)$mean[1]
d1=d1 %>% bind_rows(d2)
}
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/data"
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>% filter(!is.na(Sample))
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/data"
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>% filter(!is.na(Sample))
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/data"
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx"))
View(d)
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>% filter(!is.na(Sample))
sample=unique(d$Sample)
sample
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>%
filter(!is.na(Sample)) %>%
mutate(ID=substr(Sample,1,4))
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>%
filter(!is.na(Sample)) %>%
mutate(ID=substr(Sample,1,4),
Visit=substr(Sample,6,7))
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>%
filter(!is.na(Sample)) %>%
mutate(Visit=substr(Sample,6,7),
Sample=substr(Sample,1,4))
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>%
filter(!is.na(Sample)) %>%
mutate(Visit=substr(Sample,6,7),
Sample=substr(Sample,1,4),
x=`Mean of sample OD`/`OD/Blank ≥ 3 is positive`)
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/data"
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>%
filter(!is.na(Sample)) %>%
mutate(Visit=substr(Sample,6,7),
Sample=substr(Sample,1,4))
excel_files <- list.files(path = path, pattern = "\\.xlsx?$", full.names = TRUE)
excel_files
all_data <- lapply(excel_files, read_excel)
all_data <- excel_files %>%
lapply(read_excel) %>%
lapply(function(df) {
df %>%
filter(!is.na(Sample)) %>%
mutate(
Visit = substr(Sample, 6, 7),
Sample = substr(Sample, 1, 4)
)
}) %>%
bind_rows()
View(all_data)
unique(all_data$Sample)
177*7
table(all_data$Visit)
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/data"
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>%
filter(!is.na(Sample)) %>%
mutate(Visit=substr(Sample,6,7),
Sample=substr(Sample,1,4))
excel_files <- list.files(path = path, pattern = "\\.xlsx?$", full.names = TRUE)
all_data <- lapply(excel_files, read_excel)
all_data <- excel_files %>%
lapply(read_excel) %>%
lapply(function(df) {
df %>%
filter(!is.na(Sample)) %>%
mutate(
Visit = substr(Sample, 6, 7),
Sample = substr(Sample, 1, 4)
)
}) %>%
bind_rows()
View(all_data)
table(all_data$Sample)
all_data_1 <- lapply(excel_files, read_excel)
View(all_data_1)
all_data_1[[1]]
all_data_1[[13]]
table(all_data$Sample)
data.frame(table(all_data$Sample))
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/data"
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>%
filter(!is.na(Sample)) %>%
mutate(Visit=substr(Sample,6,7),
Sample=substr(Sample,1,4))
excel_files <- list.files(path = path, pattern = "\\.xlsx?$", full.names = TRUE)
all_data_1 <- lapply(excel_files, read_excel)
all_data <- lapply(excel_files, function(file) {
read_excel(file) %>%
filter(!is.na(Sample)) %>%
mutate(
Visit = substr(Sample, 6, 7),
Sample = substr(Sample, 1, 4),
FileName = basename(file)  # Add file name column
)
}) %>%
bind_rows()
View(all_data)
data.frame(table(all_data$Sample))
# Assuming all_data has columns: Sample and FileName
repeated_samples <- all_data %>%
group_by(Sample) %>%
summarise(file_count = n_distinct(FileName)) %>%
filter(file_count > 1)
repeated_samples
View(repeated_samples)
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/data"
d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>%
filter(!is.na(Sample)) %>%
mutate(Visit=substr(Sample,6,7),
Sample=substr(Sample,1,4))
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/data"
# d=read_xlsx(paste0(path,"/Part 1 test 2 confirm.xlsx")) %>%
#   filter(!is.na(Sample)) %>%
#   mutate(Visit=substr(Sample,6,7),
#          Sample=substr(Sample,1,4))
excel_files <- list.files(path = path, pattern = "\\.xlsx?$", full.names = TRUE)
all_data_1 <- lapply(excel_files, read_excel)
all_data <- lapply(excel_files, function(file) {
read_excel(file) %>%
filter(!is.na(Sample)) %>%
mutate(
Visit = substr(Sample, 6, 7),
Sample = substr(Sample, 1, 4),
FileName = basename(file)  # Add file name column
)
}) %>%
bind_rows()
# Assuming all_data has columns: Sample and FileName
repeated_samples <- all_data %>%
group_by(Sample) %>%
summarise(file_count = n_distinct(FileName)) %>%
filter(file_count > 1)
View(repeated_samples)
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/data"
excel_files <- list.files(path = path, pattern = "\\.xlsx?$", full.names = TRUE)
all_data_1 <- lapply(excel_files, read_excel)
all_data <- lapply(excel_files, function(file) {
read_excel(file) %>%
filter(!is.na(Sample)) %>%
mutate(
Visit = substr(Sample, 6, 7),
Sample = substr(Sample, 1, 4),
FileName = basename(file)  # Add file name column
)
}) %>%
bind_rows()
repeated_samples <- all_data %>%
group_by(Sample) %>%
summarise(file_count = n_distinct(FileName)) %>%
filter(file_count > 1)
library(readxl)
library(dplyr)
library(tidyverse)
library(forecast)
path="D:/Naser/clinical Trial/01.06.2025 Perto Immuno simulate data/data"
excel_files <- list.files(path = path, pattern = "\\.xlsx?$", full.names = TRUE)
all_data_1 <- lapply(excel_files, read_excel)
all_data <- lapply(excel_files, function(file) {
read_excel(file) %>%
filter(!is.na(Sample)) %>%
mutate(
Visit = substr(Sample, 6, 7),
sample = substr(Sample, 1, 4),
FileName = basename(file)  # Add file name column
)
}) %>%
bind_rows()
# Assuming all_data has columns: Sample and FileName
repeated_samples <- all_data %>%
group_by(sample) %>%
summarise(file_count = n_distinct(FileName)) %>%
filter(file_count > 1)
# Assuming all_data has columns: Sample and FileName
repeated_samples <- all_data %>%
group_by(Sample) %>%
summarise(file_count = n_distinct(FileName)) %>%
filter(file_count > 1)
View(repeated_samples)
# Assuming all_data has columns: Sample and FileName
repeated_samples <- all_data %>%
group_by(sample) %>%
summarise(file_count = n_distinct(FileName)) %>%
filter(file_count > 1)
View(repeated_samples)
write.csv(repeated_samples,paste0(path,"/ code.csv"))
# Install and load the ggplot2 package if you haven't already
# install.packages("ggplot2")
library(ggplot2)
# Create the data frame
sales_data <- data.frame(
Year = c(2024, 2024, 2025, 2025),
Type = c("Real", "Target", "Real", "Target"),
Out = c(28242320.00, 28242320.00, 23975252.00, 33890784.00)
)
# Convert 'Year' to a factor for proper grouping on the x-axis
sales_data$Year <- as.factor(sales_data$Year)
# Create the clustered column chart
ggplot(sales_data, aes(x = Year, y = Out, fill = Type)) +
geom_col(position = "dodge") + # geom_col creates bar charts, position = "dodge" puts bars side-by-side
labs(
title = "Real vs. Target Sales by Year",
x = "Year",
y = "Sales Amount ($)"
) +
scale_y_continuous(labels = scales::dollar_format()) + # Format y-axis as currency
theme_minimal() + # Use a minimal theme for a clean look
theme(legend.position = "bottom") + # Move legend to the bottom
geom_text(aes(label = scales::dollar(Out)),
position = position_dodge(width = 0.9), # Adjust position to match dodged bars
vjust = -0.5, # Nudge labels slightly above the bars
size = 3) # Adjust label size
# Install and load the ggplot2 package if you haven't already
# install.packages("ggplot2")
library(ggplot2)
# Create the data frame
sales_data <- data.frame(
Year = c(2024, 2025, 2025),
Type = c("Real", "Real", "Target"),
Out = c(28242320.00, 23975252.00, 33890784.00)
)
# Convert 'Year' to a factor for proper grouping on the x-axis
sales_data$Year <- as.factor(sales_data$Year)
# Create the clustered column chart
ggplot(sales_data, aes(x = Year, y = Out, fill = Type)) +
geom_col(position = "dodge") + # geom_col creates bar charts, position = "dodge" puts bars side-by-side
labs(
title = "Real vs. Target Sales by Year",
x = "Year",
y = "Sales Amount ($)"
) +
scale_y_continuous(labels = scales::dollar_format()) + # Format y-axis as currency
theme_minimal() + # Use a minimal theme for a clean look
theme(legend.position = "bottom") + # Move legend to the bottom
geom_text(aes(label = scales::dollar(Out)),
position = position_dodge(width = 0.9), # Adjust position to match dodged bars
vjust = -0.5, # Nudge labels slightly above the bars
size = 3) # Adjust label size
# Create the data frame
sales_data <- data.frame(
Year = c(2024, 2024, 2025, 2025),
Type = c("Real", "Target", "Real", "Target"),
Out = c(28242320.00, 0, 23975252.00, 33890784.00)
)
# Install and load the ggplot2 package if you haven't already
# install.packages("ggplot2")
library(ggplot2)
# Create the data frame
sales_data <- data.frame(
Year = c(2024, 2024, 2025, 2025),
Type = c("Real", "Target", "Real", "Target"),
Out = c(28242320.00, 0, 23975252.00, 33890784.00)
)
# Convert 'Year' to a factor for proper grouping on the x-axis
sales_data$Year <- as.factor(sales_data$Year)
# Create the clustered column chart
ggplot(sales_data, aes(x = Year, y = Out, fill = Type)) +
geom_col(position = "dodge") + # geom_col creates bar charts, position = "dodge" puts bars side-by-side
labs(
title = "Real vs. Target Sales by Year",
x = "Year",
y = "Sales Amount ($)"
) +
scale_y_continuous(labels = scales::dollar_format()) + # Format y-axis as currency
theme_minimal() + # Use a minimal theme for a clean look
theme(legend.position = "bottom") + # Move legend to the bottom
geom_text(aes(label = scales::dollar(Out)),
position = position_dodge(width = 0.9), # Adjust position to match dodged bars
vjust = -0.5, # Nudge labels slightly above the bars
size = 3) # Adjust label size
# Install and load the ggplot2 package if you haven't already
# install.packages("ggplot2")
library(ggplot2)
# Create the data frame
sales_data <- data.frame(
Year = c(2024, 2024, 2025, 2025),
Type = c("Real", "Target", "Real", "Target"),
Out = c(28242320.00, NA, 23975252.00, 33890784.00)
)
# Convert 'Year' to a factor for proper grouping on the x-axis
sales_data$Year <- as.factor(sales_data$Year)
# Create the clustered column chart
ggplot(sales_data, aes(x = Year, y = Out, fill = Type)) +
geom_col(position = "dodge") + # geom_col creates bar charts, position = "dodge" puts bars side-by-side
labs(
title = "Real vs. Target Sales by Year",
x = "Year",
y = "Sales Amount ($)"
) +
scale_y_continuous(labels = scales::dollar_format()) + # Format y-axis as currency
theme_minimal() + # Use a minimal theme for a clean look
theme(legend.position = "bottom") + # Move legend to the bottom
geom_text(aes(label = scales::dollar(Out)),
position = position_dodge(width = 0.9), # Adjust position to match dodged bars
vjust = -0.5, # Nudge labels slightly above the bars
size = 3) # Adjust label size
# Install and load the ggplot2 package if you haven't already
# install.packages("ggplot2")
library(ggplot2)
# Create the data frame
sales_data <- data.frame(
Year = c(2024, 2024, 2025, 2025),
Type = c("Actual sales", "Target", "Actual sales", "Target"),
Out = c(28242320.00, NA, 23975252.00, 33890784.00)
)
# Convert 'Year' to a factor for proper grouping on the x-axis
sales_data$Year <- as.factor(sales_data$Year)
# Create the clustered column chart
ggplot(sales_data, aes(x = Year, y = Out, fill = Type)) +
geom_col(position = "dodge") + # geom_col creates bar charts, position = "dodge" puts bars side-by-side
labs(
title = "Actual sales vs. Target Sales by Year",
x = "Year",
y = "Sales Amount ($)"
) +
scale_y_continuous(labels = scales::dollar_format()) + # Format y-axis as currency
theme_minimal() + # Use a minimal theme for a clean look
theme(legend.position = "bottom") + # Move legend to the bottom
geom_text(aes(label = scales::dollar(Out)),
position = position_dodge(width = 0.9), # Adjust position to match dodged bars
vjust = -0.5, # Nudge labels slightly above the bars
size = 3) # Adjust label size
# Install and load the ggplot2 package if you haven't already
# install.packages("ggplot2")
library(ggplot2)
# Create the data frame
sales_data <- data.frame(
Year = c(2024, 2024, 2025, 2025),
Type = c("Actual sales", "Target", "Actual sales", "Target"),
Out = c(28242320.00, NA, 23975252.00, 33890784.00)
)
# Convert 'Year' to a factor for proper grouping on the x-axis
sales_data$Year <- as.factor(sales_data$Year)
# Create the clustered column chart
ggplot(sales_data, aes(x = Year, y = Out, fill = Type)) +
geom_col(position = "dodge") + # geom_col creates bar charts, position = "dodge" puts bars side-by-side
labs(
# title = "Actual sales vs. Target Sales by Year",
x = "Year",
y = "Sales Amount ($)"
) +
scale_y_continuous(labels = scales::dollar_format()) + # Format y-axis as currency
theme_minimal() + # Use a minimal theme for a clean look
theme(legend.position = "bottom") + # Move legend to the bottom
geom_text(aes(label = scales::dollar(Out)),
position = position_dodge(width = 0.9), # Adjust position to match dodged bars
vjust = -0.5, # Nudge labels slightly above the bars
size = 3) # Adjust label size
shiny::runApp('D:/Naser/Shiny & Power BI/Export Shiny app/Payment-warning 3.1.1')
